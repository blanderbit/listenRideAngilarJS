//Evaluated by gulp.
"use strict";angular.module("listnride",["header","footer","home","search","bikeCard","user","bike","requests","message","list","autocomplete","listings","listingCard","edit","rating","settings","listingABike","raphaSuperCross","static","ngMaterial","ngMessages","pascalprecht.translate","ui.router","ngStorage","ezfb","ngMap","luegg.directives","ngFileUpload","ngSanitize","angular-input-stars"]).config(["$translateProvider","ezfbProvider","$mdAriaProvider","$locationProvider",function(e,t,r,a){r.disableWarnings(),t.setInitParams({appId:"895499350535682",version:"v2.3"}),a.html5Mode(!0),e.useStaticFilesLoader({prefix:"app/i18n/",suffix:".json"});var n,o=e.resolveClientLocale(),i="en",s=["de","en"];void 0!=o&&o.length>=2&&(o=o.substring(0,2)),n=s.indexOf(o)>=0?o:i,e.preferredLanguage(n),e.useSanitizeValueStrategy("sanitizeParameters")}]),angular.module("listnride").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state({name:"home",url:"/",template:"<home></home>"}),e.state({name:"bike",url:"/bikes/{bikeId:int}",template:"<bike></bike>"}),e.state({name:"search",url:"/search/{location}?size&allterrain&race&city&kids&ebikes&special",template:"<search></search>",params:{size:{value:"",squash:!0},allterrain:{value:"false",squash:!0},race:{value:"false",squash:!0},city:{value:"false",squash:!0},kids:{value:"false",squash:!0},ebikes:{value:"false",squash:!0},special:{value:"false",squash:!0}}}),e.state({name:"user",url:"/users/{userId:int}",template:"<user></user>"}),e.state({name:"wfs",url:"/wfs",template:"<user></user>"}),e.state({name:"requests",url:"/requests/{requestId:int}",params:{requestId:{squash:!0,value:null}},template:"<requests></requests>"}),e.state({name:"list",url:"/list",template:"<list></list>"}),e.state({name:"listings",url:"/listings",template:"<listings></listings>"}),e.state({name:"edit",url:"/edit/{bikeId:int}",template:"<edit></edit>"}),e.state({name:"settings",url:"/settings",template:"<settings></settings>"}),e.state({name:"raphaSuperCross",url:"/rapha-super-cross",template:"<rapha-super-cross></rapha-super-cross>"}),e.state({name:"listingABike",url:"/listing-a-bike",template:"<listing-a-bike></listing-a-bike>"}),e.state({name:"about",url:"/about",templateUrl:"app/modules/static/about.template.html"}),e.state({name:"rentingABike",url:"/renting-a-bike",templateUrl:"app/modules/static/renting-a-bike.template.html"}),e.state({name:"trustAndSafety",url:"/trust-and-safety",templateUrl:"app/modules/static/trust-and-safety.template.html"}),e.state({name:"terms",url:"/terms",templateUrl:"app/modules/static/terms.template.html"}),e.state({name:"help",url:"/help",templateUrl:"app/modules/static/help.template.html"}),e.state({name:"jobs",url:"/jobs",templateUrl:"app/modules/static/jobs.template.html"}),e.state({name:"press",url:"/press",templateUrl:"app/modules/static/press.template.html"}),e.state({name:"imprint",url:"/imprint",templateUrl:"app/modules/static/imprint.template.html"}),e.state({name:"privacy",url:"/privacy",templateUrl:"app/modules/static/privacy.template.html"}),e.state({name:"howItWorks",url:"/how-it-works",templateUrl:"app/modules/static/how-it-works.template.html"}),e.state("404",{templateUrl:"app/modules/static/error-404.template.html"}),t.otherwise(function(e,t){var r=e.get("$state");r.go("404")})}]),angular.module("listnride").config(["$mdThemingProvider",function(e){e.definePalette("lnr-blue",{50:"#ffffff",100:"#ffffff",200:"#f8fbff",300:"#b4d4fb",400:"#97c3fa",500:"#7ab2f8",600:"#5da1f6",700:"#4090f5",800:"#237ff3",900:"#0c6feb",A100:"#ffffff",A200:"#7ab2f8",A400:"#97c3fa",A700:"#4090f5",contrastDefaultColor:"light",contrastDarkColors:"50 100 200 300 A100 A400 A700"}),e.definePalette("lnr-green",{50:"#ffffff",100:"#eaf8f1",200:"#c1e9d5",300:"#8cd6b1",400:"#76cea2",500:"#5fc693",600:"#48be84",700:"#3dab74",800:"#359465",900:"#2d7e56",A100:"#ffffff",A200:"#eaf8f1",A400:"#76cea2",A700:"#3dab74",contrastDefaultColor:"light",contrastDarkColors:"50 100 200 300 A100 A200 A400 A700"}),e.definePalette("lnr-background",e.extendPalette("grey",{50:"#ffffff",A400:"#343940"}));var t={name:"dark",1:"rgba(85,85,85,1.0)",2:"rgba(68,68,68,1.0)",3:"rgba(225,230,230,1.0)",4:"rgba(206,212,216,0.9)"};e.theme("default").primaryPalette("lnr-green").accentPalette("lnr-blue").backgroundPalette("lnr-background").foregroundPalette=t,e.theme("lnr-dark").backgroundPalette("lnr-background").dark().foregroundPalette[3]="rgba(255,255,255,0.12)"}]),angular.module("listnride").filter("category",function(){return function(e){switch(e){case 10:return"Holland";case 11:return"Touring";case 12:return"Fixie";case 13:return"Single Speed";case 20:return"Roadbike";case 21:return"Triathlon";case 22:return"Indoor";case 30:return"Trecking";case 31:return"Enduro";case 32:return"Freeride";case 33:return"Cross Country";case 34:return"Downhill";case 35:return"Cyclocross";case 40:return"Children City";case 41:return"Children Allterrain";case 42:return"Children Road";case 50:return"Pedelec";case 51:return"E-Bike";case 60:return"Folding";case 61:return"Tandem";case 62:return"Cruiser";case 63:return"Cargo";case 64:return"Recumbent";case 65:return"Mono";default:return""}}}),angular.module("listnride").filter("mapCategory",function(){return function(e,t){if(void 0==e)return[];var r=Object.keys(t).map(function(e){return t[e]}),a=r.every(function(e){return e===!1});if(a)return e;var n=["city","race","allterrain","kids","ebikes","special"];return e.filter(function(e){var r=Math.floor(e.category/10)-1;return t[n[r]]===!0})}}),angular.module("ngLocale",[],["$provide",function(e){function t(e){e+="";var t=e.indexOf(".");return t==-1?0:e.length-t-1}function r(e,r){var a=r;void 0===a&&(a=Math.min(t(e),3));var n=Math.pow(10,a),o=(e*n|0)%n;return{v:a,f:o}}var a={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};e.value("$locale",{DATETIME_FORMATS:{AMPMS:["vorm.","nachm."],DAY:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],ERANAMES:["v. Chr.","n. Chr."],ERAS:["v. Chr.","n. Chr."],FIRSTDAYOFWEEK:0,MONTH:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],SHORTDAY:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],SHORTMONTH:["Jan.","Feb.","März","Apr.","Mai","Juni","Juli","Aug.","Sep.","Okt.","Nov.","Dez."],STANDALONEMONTH:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],WEEKENDRANGE:[5,6],fullDate:"EEEE, d. MMMM y",longDate:"d. MMMM y",medium:"dd.MM.y HH:mm:ss",mediumDate:"dd.MM.y",mediumTime:"HH:mm:ss",short:"dd.MM.yy HH:mm",shortDate:"dd.MM.yy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"€",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:" ¤",posPre:"",posSuf:" ¤"}]},id:"de",localeID:"de",pluralCat:function(e,t){var n=0|e,o=r(e,t);return 1==n&&0==o.v?a.ONE:a.OTHER}})}]),angular.module("bike",[]).component("bike",{templateUrl:"app/modules/bike/bike.template.html",controllerAs:"bike",controller:["api","$stateParams","$mdDialog","$mdMedia","NgMap",function(e,t,r,a,n){function o(e,t){var r=this;r.image_1=t.image_file_1.image_file_1.url,r.image_2=t.image_file_2.image_file_2.url,r.image_3=t.image_file_3.image_file_3.url,r.image_4=t.image_file_4.image_file_4.url,r.image_5=t.image_file_5.image_file_5.url,r.hide=function(){e.hide()}}o.$inject=["$mdDialog","bikeData"];var i=this;i.mapOptions={lat:0,lng:0,zoom:14,radius:500},i.mobileCalendar=function(){return!(!a("xs")&&!a("sm"))},e.get("/rides/"+t.bikeId).then(function(e){i.data=e.data,i.mapOptions.lat=i.data.lat_rnd,i.mapOptions.lng=i.data.lng_rnd},function(e){console.log("Error retrieving bike",e)}),i.showGalleryDialog=function(e){r.show({controller:o,controllerAs:"galleryDialog",templateUrl:"app/modules/bike/galleryDialog.template.html",locals:{bikeData:i.data},parent:angular.element(document.body),targetEvent:e,openFrom:angular.element(document.body),closeTo:angular.element(document.body),clickOutsideToClose:!0,fullscreen:!0}).then(function(e){},function(){})},i.showCalendarDialog=function(){r.show({controller:s,controllerAs:"calendarDialog",templateUrl:"app/modules/bike/calendarDialog.template.html",parent:angular.element(document.body),targetEvent:event,openFrom:angular.element(document.body),closeTo:angular.element(document.body),clickOutsideToClose:!0,fullscreen:!0})};var s=function(){var e=this;e.bike=i,e.hide=function(){r.hide()}}}]}),angular.module("bike").component("calendar",{templateUrl:"app/modules/bike/calendar.template.html",controllerAs:"calendar",bindings:{bikeId:"<",bikeFamily:"<",userId:"<",priceHalfDay:"<",priceDay:"<",priceWeek:"<",requests:"<"},controller:["$scope","$localStorage","$state","$mdDialog","date","api","authentication","verification",function(e,t,r,a,n,o,i,s){function l(e){e.setHours(0,0,0,0);var t=new Date;return t.setHours(0,0,0,0),e.getTime()<t.getTime()?[!1,"date-past",""]:u(e)?[!1,"date-reserved",""]:[!0,"date-available",""]}function u(e){for(var t=0;t<m.requests.length;++t){var r=new Date(m.requests[t].start_date);r.setHours(0,0,0,0);var a=new Date(m.requests[t].end_date);if(a.setHours(0,0,0,0),r.getTime()<=e.getTime()&&e.getTime()<=a.getTime())return!0}return!1}function c(){m.startTime=10,m.endTime=18,m.duration=n.duration(void 0,void 0),m.subtotal=0,m.lnrFee=0,m.total=0,m.formValid=!1,m.datesValid=!1}function d(e,t){if(m.isDateInvalid())m.duration=n.duration(void 0,void 0),m.subtotal=0,m.lnrFee=0,m.total=0;else{m.duration=n.duration(e,t);var r=n.subtotal(e,t,m.priceHalfDay,m.priceDay,m.priceWeek),a=.125*r,o=.19*a;m.subtotal=r,m.lnrFee=a+o,m.total=r+a+o}}var m=this;m.authentication=i,c();var p=e.$watch("calendar.requests",function(){void 0!==m.requests&&(p(),m.owner=m.userId==t.userId,2==m.bikeFamily&&m.event.reserved(),angular.element("#bikeCalendar").dateRangePicker({alwaysOpen:!0,container:"#bikeCalendar",beforeShowDay:l,inline:!0,selectForward:!0,showShortcuts:!1,showTopbar:!1,singleMonth:!0,startOfWeek:"monday"}).bind("datepicker-change",function(t,r){var a=r.date1;a.setHours(m.startTime,0,0,0);var n=r.date2;n.setHours(m.endTime,0,0,0),e.$apply(function(){m.startDate=a,m.endDate=n,d(m.startDate,m.endDate)})}))});m.onTimeChange=function(e){var t=e+"Date",r=e+"Time",a=new Date(m[t]);a.setHours(m[r],0,0,0),m[t]=a,d(m.startDate,m.endDate)},m.onBikeRequest=function(){a.hide(),o.get("/users/"+t.userId).then(function(e){var a=e.data;if(2==m.bikeFamily||a.has_address&&a.confirmed_phone&&a.status>=1){var n={user_id:t.userId,ride_id:m.bikeId,start_date:m.startDate.toISOString(),end_date:m.endDate.toISOString()};o.post("/requests",n).then(function(e){r.go("requests",{requestId:e.data.id}),console.log("Success",e)},function(e){console.log("Error posting request",e)})}else s.openDialog(!1)},function(e){})},m.isFormInvalid=function(){return void 0===m.bikeId||void 0===m.startDate||void 0!==m.startDate&&m.startDate.getTime()>=m.endDate.getTime()},m.isDateInvalid=function(){return void 0!==m.startDate&&m.startDate.getTime()>=m.endDate.getTime()},m.event={},m.event.slotId;var f=2,g=2016,h=10;m.event.slots=[{overnight:!1,reserved:!1,day:21,month:h,year:g,text:"18:00 - 20:00",startTime:18},{overnight:!1,reserved:!1,day:21,month:h,year:g,text:"20:00 - 22:00",startTime:20},{overnight:!0,reserved:!1,day:21,month:h,year:g,text:"Overnight (22:00 - 10:00)",startTime:22},{overnight:!1,reserved:!1,day:22,month:h,year:g,text:"10:00 - 12:00",startTime:10},{overnight:!1,reserved:!1,day:22,month:h,year:g,text:"12:00 - 14:00",startTime:12},{overnight:!1,reserved:!1,day:22,month:h,year:g,text:"14:00 - 16:00",startTime:14},{overnight:!1,reserved:!1,day:22,month:h,year:g,text:"16:00 - 18:00",startTime:16},{overnight:!1,reserved:!1,day:22,month:h,year:g,text:"18:00 - 20:00",startTime:18},{overnight:!1,reserved:!1,day:22,month:h,year:g,text:"20:00 - 22:00",startTime:20},{overnight:!0,reserved:!1,day:22,month:h,year:g,text:"Overnight (22:00 - 10:00)",startTime:22},{overnight:!1,reserved:!1,day:23,month:h,year:g,text:"10:00 - 12:00",startTime:10},{overnight:!1,reserved:!1,day:23,month:h,year:g,text:"12:00 - 14:00",startTime:12},{overnight:!1,reserved:!1,day:23,month:h,year:g,text:"14:00 - 16:00",startTime:14},{overnight:!1,reserved:!1,day:23,month:h,year:g,text:"16:00 - 18:00",startTime:16}],m.event.changeSlot=function(){var e=m.event.slots[m.event.slotId];m.startDate=new Date(g,h-1,e.day,e.startTime,0,0,0),e.overnight?m.endDate=new Date(g,h-1,e.day+1,10,0,0,0):m.endDate=new Date(g,h-1,e.day,e.startTime+f,0,0,0),d(m.startDate,m.endDate)},m.event.reserved=function(){for(var e=0;e<m.requests.length;e++){console.log(e);var t=new Date(m.requests[e].start_date),r=new Date(m.requests[e].end_date),a=t.getDate(),n=t.getHours(),o=r.getHours(),i=t.getFullYear(),s=t.getMonth();console.log(a,n,o);for(var l=0;l<m.event.slots.length;l++)i==g&&s==h-1&&m.event.slots[l].day==a&&m.event.slots[l].startTime>=n&&(m.event.slots[l].overnight||m.event.slots[l].startTime+f<=o)&&(m.event.slots[l].reserved=!0)}}}]}),angular.module("edit",[]).component("edit",{templateUrl:"app/modules/edit/edit.template.html",controllerAs:"edit",controller:["$mdDialog","$localStorage","$state","$stateParams","Upload","bikeOptions","api","accessControl","loadingDialog",function(e,t,r,a,n,o,i,s,l){function u(){return void 0!==f.form.mainCategory&&void 0!==f.form.subCategory}function c(){return void 0!==f.form.name&&void 0!==f.form.brand&&void 0!==f.form.size&&void 0!==f.form.description}function d(){return f.form.images.length>0}function m(){return void 0!==f.form.street&&void 0!==f.form.zip&&void 0!==f.form.city&&void 0!==f.form.country}function p(){return void 0!==f.form.price_half_daily&&void 0!==f.form.price_daily&&void 0!==f.form.price_weekly}if(!s.requireLogin()){var f=this;f.form={images:[]},f.selectedIndex=0,f.sizeOptions=o.sizeOptions(),f.kidsSizeOptions=o.kidsSizeOptions(),f.categoryOptions=o.categoryOptions(),f.subcategoryOptions=o.subcategoryOptions(),f.accessoryOptions=o.accessoryOptions(),i.get("/rides/"+a.bikeId).then(function(e){var r=e.data;if(r.user.id==t.userId){for(var a=[],n=1;n<=5;++n)void 0!==r["image_file_"+n]&&null!==r["image_file_"+n]["image_file_"+n].small.url&&a.push({src:r["image_file_"+n],url:r["image_file_"+n]["image_file_"+n].small.url,local:"false"});r.images=a,r.price_half_daily=parseInt(r.price_half_daily),r.price_daily=parseInt(r.price_daily),r.price_weekly=parseInt(r.price_weekly),r.size=parseInt(r.size),r.mainCategory=(r.category+"").charAt(0),r.subCategory=(r.category+"").charAt(1),f.form=r}},function(e){console.log("Error editing bike",e)}),f.onFormSubmit=function(){f.submitDisabled=!0,l.open();var e={"ride[name]":f.form.name,"ride[brand]":f.form.brand,"ride[description]":f.form.description,"ride[size]":f.form.size,"ride[category]":f.form.mainCategory.concat(f.form.subCategory),"ride[has_lock]":f.form.has_lock||!1,"ride[has_helmet]":f.form.has_helmet||!1,"ride[has_lights]":f.form.has_lights||!1,"ride[has_basket]":f.form.has_basket||!1,"ride[has_trailer]":f.form.has_trailer||!1,"ride[has_childseat]":f.form.has_childseat||!1,"ride[user_id]":t.userId,"ride[street]":f.form.street,"ride[city]":f.form.city,"ride[zip]":f.form.zip,"ride[country]":f.form.country,"ride[price_half_daily]":f.form.price_half_daily,"ride[price_daily]":f.form.price_daily,"ride[price_weekly]":f.form.price_weekly,"ride[image_file_1]":f.form.images[0]?f.form.images[0].src:void 0,"ride[image_file_2]":f.form.images[1]?f.form.images[1].src:void 0,"ride[image_file_3]":f.form.images[2]?f.form.images[2].src:void 0,"ride[image_file_4]":f.form.images[3]?f.form.images[3].src:void 0,"ride[image_file_5]":f.form.images[4]?f.form.images[4].src:void 0};n.upload({method:"PUT",url:i.getApiUrl()+"/rides/"+a.bikeId,data:e,headers:{Authorization:t.auth}}).then(function(e){l.close(),r.go("bike",{bikeId:e.data.id}),console.log("Success",e)},function(e){f.submitDisabled=!1,hloadingDialog.close(),console.log("Error while listing bike",e)})},f.nextTab=function(){f.selectedIndex=f.selectedIndex+1,console.log(f.form)},f.previousTab=function(){f.selectedIndex=f.selectedIndex-1,console.log(f.form)},f.addImage=function(e){if(e&&e.length)for(var t=0;t<e.length&&f.form.images.length<5;++t)null!=e[t]&&f.form.images.push({src:e[t],local:"true"})},f.removeImage=function(e){f.form.images.splice(e,1),console.log(f.form.images)},f.isFormValid=function(){return u()&&c()&&d()&&m()&&p()},f.categoryChange=function(e){4!=f.form.mainCategory&&4!=e||(f.form.size=void 0)},f.fillAddress=function(e){var t=e.address_components;if(t){for(var r={street_number:"",route:"",locality:"",country:"",postal_code:""},a=0;a<t.length;a++){var n=t[a].types[0];n in r&&(r[n]=t[a].long_name)}f.form.street=r.route+" "+r.street_number,f.form.zip=r.postal_code,f.form.city=r.locality,f.form.country=r.country}}}}]}),angular.module("footer",["pascalprecht.translate"]).component("footer",{templateUrl:"app/modules/footer/footer.template.html",controllerAs:"footer",controller:["$window","$translate",function(e,t){function r(e){return"en"===e?"English":"de"===e?"Deutsch":"English"}var a=this;a.language=r(t.use()),a.switchLanguage=function(e){t.use(e).then(function(t){a.language=r(e),document.querySelector("md-content.single-column").scrollTop=0})},a.onFacebookClick=function(){e.open("https://www.facebook.com/Listnride","_blank")},a.onInstagramClick=function(){e.open("https://instagram.com/listnride/","_blank")},a.onAppClick=function(){e.open("https://itunes.apple.com/de/app/list-n-ride/id992114091?l="+t.use(),"_blank")}}]}),angular.module("header",[]).component("header",{templateUrl:"app/modules/header/header.template.html",controllerAs:"header",controller:["$mdSidenav","$localStorage","api","authentication","verification",function(e,t,r,a,n){var o=this;o.authentication=a,o.verification=n,o.name=t.name,o.userId=t.userId,o.unreadMessages=t.unreadMessages,o.toggleSidebar=function(){e("right").toggle()}}]}),angular.module("home",[]).component("home",{templateUrl:"app/modules/home/home.template.html",controllerAs:"home",controller:["$state","api",function(e,t){var r=this;t.get("/featured").then(function(e){r.featuredBikes=e.data.slice(0,6)}),r.onSearch=function(){var t=document.querySelector("#home.autocompleteSearch").value;e.go("search",{location:t})}}]}),angular.module("list",[]).component("list",{templateUrl:"app/modules/list/list.template.html",controllerAs:"list",controller:["$mdDialog","$localStorage","$state","$scope","Upload","bikeOptions","api","$timeout","verification","accessControl","loadingDialog",function(e,t,r,a,n,o,i,s,l,u,c){if(!u.requireLogin()){var d=this;d.form={images:[]},i.get("/users/"+t.userId).then(function(e){var t=e.data;t.has_address&&t.confirmed_phone&&0!=t.status||l.openDialog(!0),d.form.street=t.street,d.form.zip=t.zip,d.form.city=t.city,d.form.country=t.country},function(e){console.log("Error fetching User")}),d.selectedIndex=0,d.sizeOptions=o.sizeOptions(),d.kidsSizeOptions=o.kidsSizeOptions(),d.categoryOptions=o.categoryOptions(),d.subcategoryOptions=o.subcategoryOptions(),d.accessoryOptions=o.accessoryOptions(),d.onFormSubmit=function(){d.submitDisabled=!0,c.open();var e={"ride[name]":d.form.name,"ride[brand]":d.form.brand,"ride[description]":d.form.description,"ride[size]":d.form.size,"ride[category]":d.form.mainCategory.concat(d.form.subCategory),"ride[has_lock]":d.form.has_lock||!1,"ride[has_helmet]":d.form.has_helmet||!1,"ride[has_lights]":d.form.has_lights||!1,"ride[has_basket]":d.form.has_basket||!1,"ride[has_trailer]":d.form.has_trailer||!1,"ride[has_childseat]":d.form.has_childseat||!1,"ride[user_id]":t.userId,"ride[street]":d.form.street,"ride[city]":d.form.city,"ride[zip]":d.form.zip,"ride[country]":d.form.country,"ride[price_half_daily]":d.form.price_half_daily,"ride[price_daily]":d.form.price_daily,"ride[price_weekly]":d.form.price_weekly,"ride[image_file_1]":d.form.images[0],"ride[image_file_2]":d.form.images[1],"ride[image_file_3]":d.form.images[2],"ride[image_file_4]":d.form.images[3],"ride[image_file_5]":d.form.images[4]};i.get("/users/"+t.userId).then(function(a){var o=a.data;o.has_address&&o.confirmed_phone&&0!=o.status?n.upload({method:"POST",url:i.getApiUrl()+"/rides",data:e,headers:{Authorization:t.auth}}).then(function(e){c.close(),r.go("listings")},function(e){d.submitDisabled=!1,c.close(),console.log("Error while listing bike",e)}):(l.openDialog(!1),d.submitDisabled=!1)},function(e){console.log("Error fetching User")})},d.nextTab=function(){d.selectedIndex=d.selectedIndex+1},d.previousTab=function(){d.selectedIndex=d.selectedIndex-1},d.addImage=function(e){if(e&&e.length)for(var t=0;t<e.length&&d.form.images.length<5;++t)null!=e[t]&&d.form.images.push(e[t])},d.removeImage=function(e){d.form.images.splice(e,1)},d.isCategoryValid=function(){return void 0!==d.form.mainCategory&&void 0!==d.form.subCategory},d.isDetailsValid=function(){return void 0!==d.form.name&&void 0!==d.form.brand&&void 0!==d.form.size&&void 0!==d.form.description},d.isPictureValid=function(){return d.form.images.length>0},d.isLocationValid=function(){return void 0!==d.form.street&&void 0!==d.form.zip&&void 0!==d.form.city&&void 0!==d.form.country},d.isPricingValid=function(){return void 0!==d.form.price_half_daily&&void 0!==d.form.price_daily&&void 0!==d.form.price_weekly},d.categoryChange=function(e){4!=d.form.mainCategory&&4!=e||(d.form.size=void 0)},d.fillAddress=function(e){var t=e.address_components;if(t){for(var r={street_number:"",route:"",locality:"",country:"",postal_code:""},a=0;a<t.length;a++){var n=t[a].types[0];n in r&&(r[n]=t[a].long_name)}d.form.street=r.route+" "+r.street_number,d.form.zip=r.postal_code,d.form.city=r.locality,d.form.country=r.country}}}}]}),angular.module("listingABike",[]).component("listingABike",{templateUrl:"app/modules/listing-a-bike/listing-a-bike.template.html",controllerAs:"listingABike",controller:["authentication",function(e){var t=this;t.authentication=e}]}),angular.module("listings",[]).component("listings",{templateUrl:"app/modules/listings/listings.template.html",controllerAs:"listings",controller:["$localStorage","api","accessControl",function(e,t,r){if(!r.requireLogin()){var a=this;t.get("/users/"+e.userId+"/rides").then(function(e){console.log(e.data),a.bikes=e.data},function(e){console.log("Error retrieving User",e)}),a.removeBike=function(e){a.bikes=a.bikes.filter(function(t){return t.id!=e})}}}]}),angular.module("requests",[]).component("requests",{templateUrl:"app/modules/requests/requests.template.html",controllerAs:"requests",controller:["$localStorage","$interval","$mdMedia","$mdDialog","$window","api","$timeout","$location","$anchorScroll","$state","$stateParams","$translate","date","accessControl",function(e,t,r,a,n,o,i,s,l,u,c,d,m,p){if(!p.requireLogin()){var f,g=this;g.requests=[],g.request={},g.message="",g.showChat=!1,g.$mdMedia=r,g.request.glued=!1,g.loadingList=!0,g.loadingChat=!1,g.request.rideChat,g.request.chatFlow,g.userId=e.userId,o.get("/users/"+e.userId+"/requests").then(function(e){g.requests=e.data,g.loadingList=!1,c.requestId&&g.loadRequest(c.requestId)},function(e){console.log("Error fetching request list"),g.loadingList=!1});var h=function(){r("xs")?y():a.hide()};g.loadRequest=function(e){u.go(".",{requestId:e},{notify:!1}),g.loadingChat=!0,t.cancel(f),g.request={},v(e),f=t(function(){v(e)},1e4),r("xs")?(g.showChat=!1,y()):g.showChat=!0},g.profilePicture=function(t){return e.userId==t.user.id?t.ride.image_file_1.thumb.url:t.user.profile_picture.url};var v=function(t){o.get("/requests/"+t).then(function(r){null!=g.request.messages&&g.request.messages.length==r.data.messages.length||(g.request=r.data,g.request.glued=!0,g.request=r.data,g.request.rideChat=e.userId==g.request.user.id,g.request.rideChat?g.request.chatFlow="rideChat":g.request.chatFlow="listChat",g.request.rideChat?(g.request.rating=g.request.lister.rating_lister+g.request.lister.rating_rider,0!=g.request.lister.rating_lister&&0!=g.request.lister.rating_rider&&(g.request.rating=g.request.rating/2)):(g.request.rating=g.request.user.rating_lister+g.request.user.rating_rider,0!=g.request.user.rating_lister&&0!=g.request.user.rating_rider&&(g.request.rating=g.request.rating/2)),g.request.rating=Math.round(g.request.rating),g.loadingChat=!1),o.post("/requests/"+t+"/messages/mark_as_read",{user_id:e.userId}).then(function(e){},function(e){})},function(e){g.loadingChat=!1,console.log("Error fetching request!")})};g.confirmBooking=function(){o.get("/users/"+e.userId).then(function(e){2==g.request.ride.family||e.data.current_payment_method?_():b()},function(e){console.log("Error retrieving User Details")})};var b=function(e){a.show({controller:C,controllerAs:"paymentDialog",templateUrl:"app/modules/requests/paymentDialog.template.html",parent:angular.element(document.body),targetEvent:e,openFrom:angular.element(document.body),closeTo:angular.element(document.body),clickOutsideToClose:!0,fullscreen:!1})},y=function(e){a.show({controller:k,controllerAs:"chatDialog",templateUrl:"app/modules/requests/chatDialog.template.html",parent:angular.element(document.body),targetEvent:e,openFrom:angular.element(document.body),closeTo:angular.element(document.body),clickOutsideToClose:!1,fullscreen:!0})},_=function(e){a.show({controller:w,controllerAs:"bookingDialog",templateUrl:"app/modules/requests/bookingDialog.template.html",parent:angular.element(document.body),targetEvent:e,openFrom:angular.element(document.body),closeTo:angular.element(document.body),clickOutsideToClose:!1,fullscreen:!0})};g.showRatingDialog=function(e){a.show({controller:D,controllerAs:"ratingDialog",templateUrl:"app/modules/requests/ratingDialog.template.html",parent:angular.element(document.body),targetEvent:e,openFrom:angular.element(document.body),closeTo:angular.element(document.body),clickOutsideToClose:!1,fullscreen:!0})},g.$onDestroy=function(){t.cancel(f)},g.sendMessage=function(){if(g.request.glued=!0,g.message){var t={request_id:g.request.id,sender:e.userId,content:g.message,is_read:!1},r={message:t};g.request.messages.push(t),o.post("/messages",r).then(function(e){v(g.request.id)},function(e){console.log("Error occured sending message")})}else confirmBooking();g.message=""};var k=function(){var e=this;e.requests=g,e.hide=function(){a.hide()}},w=function(){var e=this;e.requests=g,e.duration=m.duration(g.request.start_date,g.request.end_date),e.hide=h,e.book=function(){var t={request:{status:3}};e.hide(),g.loadingChat=!0,o.put("/requests/"+g.request.id,t).then(function(e){v(g.request.id)},function(e){v(g.request.id),console.log("error updating request")})}},C=function(){var t=this;t.openPaymentForm=function(){var t=550,r=700,a=screen.width/2-t/2,o=screen.height/2-r/2,i=d.proposedLanguage();console.log(i),n.open("https://api.listnride.com/v2/users/"+e.userId+"/payment_methods/new","popup","width="+t+",height="+r+",left="+a+",top="+o),h()}},D=function(){var t=this;t.rating=5,t.rate=function(){var r,a={rating:{score:t.rating,message:t.message,author_id:e.userId}};g.request.rideChat?(a.rating.ride_id=g.request.ride.id,r=6):(a.rating.user_id=g.request.user.id,r=5),g.loadingChat=!0,t.hide(),o.post("/ratings",a).then(function(e){var t={request:{status:r}};o.put("/requests/"+g.request.id,t).then(function(e){v(g.request.id)},function(e){v(g.request.id),console.log("error updating request")})},function(e){console.log("Error occured while rating")})},t.hide=h}}}]}),angular.module("search",[]).component("search",{templateUrl:"app/modules/search/search.template.html",controllerAs:"search",bindings:{location:"<"},controller:["$translate","$http","$stateParams","$state","NgMap","api",function(e,t,r,a,n,o){function i(){o.get("/rides?location="+s.location).then(function(e){s.bikes=e.data,s.bikes.length>0?(s.mapOptions.lat=s.bikes[0].lat_rnd,s.mapOptions.lng=s.bikes[0].lng_rnd,s.mapOptions.zoom=10):(s.mapOptions.lat=51.1657,s.mapOptions.lng=10.4515,s.mapOptions.zoom=4)},function(e){console.log("Error retrieving bikes")})}var s=this;s.location=r.location,s.sizeFilter={size:r.size},s.categoryFilter={allterrain:"true"==r.allterrain,city:"true"==r.city,ebikes:"true"==r.ebikes,kids:"true"==r.kids,race:"true"==r.race,special:"true"==r.special},s.sizeOptions=[{value:"",label:"-"},{value:155,label:"155 - 165"},{value:165,label:"165 - 175"},{value:175,label:"175 - 185"},{value:185,label:"185 - 195"},{value:195,label:"195 - 205"}],e("search.all-sizes").then(function(e){s.sizeOptions[0].label=e}),s.mapOptions={lat:40,lng:-74,zoom:5},i(),n.getMap({id:"searchMap"}).then(function(e){console.log(e,e.infoWindows.infoWindow),s.map=e}),s.showBikeWindow=function(e,t){s.map&&(s.selectedBike=s.bikes.find(function(e){return e.id==t}),s.map.showInfoWindow("searchMapWindow",this))},s.onLocationChange=function(){var e=document.querySelector("#search.autocompleteSearch").value;s.location=e,a.go(".",{location:e},{notify:!1}),s.bikes=void 0,i()},s.onSizeChange=function(){a.go(".",{size:s.sizeFilter.size},{notify:!1})},s.onCategoryChange=function(e){var t={};t[e]=s.categoryFilter[e],a.go(".",t,{notify:!1})},s.onMapClick=function(e){s.map&&(s.map.hideInfoWindow("searchMapWindow"),s.selectedBike=void 0)}}]}),angular.module("settings",[]).component("settings",{templateUrl:"app/modules/settings/settings.template.html",controllerAs:"settings",controller:["$localStorage","$window","$mdToast","$translate","api","accessControl","sha256","Base64","Upload","loadingDialog",function(e,t,r,a,n,o,i,s,l,u){if(!o.requireLogin()){var c=this;c.user={},c.loaded=!1,c.payoutMethod={},c.password="",n.get("/users/"+e.userId).then(function(e){c.user=e.data,console.log(c.user),c.loaded=!0},function(e){console.log("Error retrieving User",e)}),c.addPayoutMethod=function(){var t={payment_method:c.payoutMethod};t.payment_method.user_id=e.userId,1==c.payoutMethod.family?t.payment_method.email="":(t.payment_method.iban="",t.payment_method.bic=""),n.post("/users/"+e.userId+"/payment_methods",t).then(function(e){r.show(r.simple().textContent(a.instant("toasts.add-payout-success")).hideDelay(4e3).position("top center"))},function(e){r.show(r.simple().textContent(a.instant("toasts.error")).hideDelay(4e3).position("top center"))})},c.addVoucher=function(){var e={voucher:{code:c.voucherCode}};n.post("/vouchers",e).then(function(e){c.user.balance=parseInt(c.user.balance)+parseInt(e.data.value),c.voucherCode="",r.show(r.simple().textContent(a.instant("toasts.add-voucher-success")).hideDelay(4e3).position("top center"))},function(e){c.voucherCode="",r.show(r.simple().textContent(a.instant("toasts.add-voucher-error")).hideDelay(4e3).position("top center"))})},c.updateUser=function(){var t={user:{description:c.user.description,profile_picture:c.profilePicture,street:c.user.street,zip:c.user.zip,city:c.user.city,country:c.user.country}};c.password&&c.password.length>=6&&(console.log("Updating Password"),t.user.password_hashed=i.encrypt(c.password)),u.open(),l.upload({method:"PUT",url:n.getApiUrl()+"/users/"+e.userId,data:t,headers:{Authorization:e.auth}}).then(function(t){u.close(),r.show(r.simple().textContent(a.instant("toasts.update-profile-success")).hideDelay(4e3).position("top center")),c.user=t.data,e.profilePicture=t.data.profile_picture.profile_picture.url;var n=s.encode(t.data.email+":"+t.data.password_hashed);e.auth="Basic "+n},function(e){u.close(),r.show(r.simple().textContent(a.instant("toasts.error")).hideDelay(4e3).position("top center"))})},c.openPaymentWindow=function(){var r=550,a=700,n=screen.width/2-r/2,o=screen.height/2-a/2;t.open("https://api.listnride.com/v2/users/"+e.userId+"/payment_methods/new","popup","width="+r+",height="+a+",left="+n+",top="+o)}}}]}),angular.module("header").component("sidebar",{templateUrl:"app/modules/sidebar/sidebar.template.html",controllerAs:"sidebar",controller:["$mdSidenav","$localStorage","authentication",function(e,t,r){var a=this;a.authentication=r,a.userId=t.userId,a.toggle=function(){e("right").toggle()}}]}),angular.module("static",[]).component("static",{controllerAs:"static",
controller:["$translate",function(e){accessControl.requireLogin()}]}),angular.module("user",[]).component("user",{templateUrl:"app/modules/user/user.template.html",controllerAs:"user",controller:["$localStorage","$stateParams","api",function(e,t,r){var a=this;a.loaded=!1;var n;n=t.userId?t.userId:1282,r.get("/users/"+n).then(function(e){console.log(e.data),a.user=e.data,a.loaded=!0,a.rating=a.user.lister_rating+a.user.rider_rating,0!=a.user.lister_rating&&0!=a.user.rider_rating&&(a.rating=a.rating/2),a.rating=Math.round(a.rating)},function(e){console.log("Error retrieving User",e)})}]}),angular.module("listnride").factory("accessControl",["$localStorage","$state",function(e,t){return{requireLogin:function(){return void 0==e.userId&&(t.go("home"),!0)}}}]),angular.module("listnride").factory("api",["$http","$localStorage",function(e,t,r){var a="https://api.listnride.com/v2";return{get:function(r){return e({method:"GET",url:a+r,headers:{"Content-Type":"application/json",Authorization:t.auth}})},post:function(r,n){return e({method:"POST",url:a+r,data:n,headers:{"Content-Type":"application/json",Authorization:t.auth}})},put:function(r,n){return e({method:"PUT",url:a+r,data:n,headers:{"Content-Type":"application/json",Authorization:t.auth}})},getApiUrl:function(){return a}}}]),angular.module("listnride").factory("authentication",["Base64","$http","$localStorage","$mdDialog","$mdToast","$window","$state","$q","ezfb","api","verification","sha256",function(e,t,r,a,n,o,i,s,l,u,c,d){var m=function(t,a,n,o,i,s,l){var u=e.encode(t+":"+a);r.auth="Basic "+u,r.userId=n,r.name=i+" "+s,r.firstName=i,r.profilePicture=o,r.unreadMessages=l,r.email=t},p=function(e){var t=this,r=function(e,t,r,a,n,o){var i={user:{email:e,facebook_id:t,facebook_access_token:r,profile_picture_url:a,first_name:n,last_name:o}};u.post("/users",i).then(function(e){m(e.data.email,e.data.password_hashed,e.data.id,e.data.profile_picture.profile_picture.url,e.data.first_name,e.data.last_name,e.data.unread_messages),c.openDialog()},function(e){console.log("Could not Sign Up with Facebook")})};t.hide=function(){e.hide()},t.signup=function(){var e={user:{email:t.email,password_hashed:d.encrypt(t.password),first_name:t.firstName,last_name:t.lastName}};u.post("/users",e).then(function(e){m(e.data.email,e.data.password_hashed,e.data.id,e.data.profile_picture.profile_picture.url,e.data.first_name,e.data.last_name,e.data.unread_messages),c.openDialog()},function(e){console.log("Could not Sign Up")})},t.connectFb=function(){l.getLoginStatus(function(e){if("connected"===e.status){var t=e.authResponse.accessToken;l.api("/me?fields=id,email,first_name,last_name,picture.width(600).height(600)",function(e){r(e.email,e.id,t,e.picture.data.url,e.first_name,e.last_name)})}else l.login(function(e){l.api("/me?fields=id,email,first_name,last_name,picture.width(600).height(600)",function(e){r(e.email,e.id,t,e.picture.data.url,e.first_name,e.last_name)})})})}};p.$inject=["$mdDialog"];var f=function(e,t,r,a){var n=this,o=function(){e.hide(),t.show(t.simple().textContent("Successfully logged in.").hideDelay(3e3).position("top center"))},i=function(){t.show(t.simple().textContent("Could not log in. Please make sure you've entered valid credentials and signed up already.").hideDelay(4e3).position("top center"))},s=function(e,t){var r={user:{email:e,facebook_id:t}};u.post("/users/login",r).then(function(e){m(e.data.email,e.data.password_hashed,e.data.id,e.data.profile_picture.profile_picture.url,e.data.first_name,e.data.last_name,e.data.unread_messages),o()},function(e){i()})};n.hide=function(){e.hide()},n.login=function(){var e={user:{email:n.email,password_hashed:r.encrypt(n.password)}};u.post("/users/login",e).then(function(e){console.log(e.data),m(e.data.email,e.data.password_hashed,e.data.id,e.data.profile_picture.profile_picture.url,e.data.first_name,e.data.last_name,e.data.unread_messages),o()},function(e){console.log(e),i()})},n.connectFb=function(){a.getLoginStatus(function(e){"connected"===e.status?a.api("/me?fields=id,email,first_name,last_name,picture.width(600).height(600)",function(e){console.log(e),s(e.email,e.id)}):a.login(function(e){a.api("/me?fields=id,email,first_name,last_name,picture.width(600).height(600)",function(e){console.log(e),s(e.email,e.id)})},{scope:"email"})})},n.resetPassword=function(){var e={user:{email:n.email}};u.post("/users/reset_password",e).then(function(e){t.show(t.simple().textContent("Please check your emails, we've just sent you a new password.").hideDelay(5e3).position("top center"))},function(e){console.log(response)})}};f.$inject=["$mdDialog","$mdToast","sha256","ezfb"];var g=function(e){a.show({controller:p,controllerAs:"signupDialog",templateUrl:"app/services/authentication/signupDialog.template.html",parent:angular.element(document.body),targetEvent:e,openFrom:angular.element(document.body),closeTo:angular.element(document.body),clickOutsideToClose:!0,fullscreen:!0}).then(function(e){},function(){})},h=function(e){a.show({controller:f,controllerAs:"loginDialog",templateUrl:"app/services/authentication/loginDialog.template.html",parent:angular.element(document.body),targetEvent:e,openFrom:angular.element(document.body),closeTo:angular.element(document.body),clickOutsideToClose:!0,fullscreen:!0}).then(function(e){},function(){})},v=function(){return!!r.auth},b=function(){document.execCommand("ClearAuthenticationCache"),delete r.auth,delete r.userId,delete r.profilePicture,delete r.name,i.go("home"),n.show(n.simple().textContent("You are logged out.").hideDelay(3e3).position("top center"))};return{showSignupDialog:g,showLoginDialog:h,loggedIn:v,logout:b,profilePicture:function(){return r.profilePicture},userId:function(){return r.userId}}}]),angular.module("listnride").factory("Base64",function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(t){var r,a,n,o,i,s="",l="",u="",c=0;do r=t.charCodeAt(c++),a=t.charCodeAt(c++),l=t.charCodeAt(c++),n=r>>2,o=(3&r)<<4|a>>4,i=(15&a)<<2|l>>6,u=63&l,isNaN(a)?i=u=64:isNaN(l)&&(u=64),s=s+e.charAt(n)+e.charAt(o)+e.charAt(i)+e.charAt(u),r=a=l="",n=o=i=u="";while(c<t.length);return s},decode:function(t){var r,a,n,o,i,s="",l="",u="",c=0,d=/[^A-Za-z0-9\+\/\=]/g;d.exec(t)&&alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do n=e.indexOf(t.charAt(c++)),o=e.indexOf(t.charAt(c++)),i=e.indexOf(t.charAt(c++)),u=e.indexOf(t.charAt(c++)),r=n<<2|o>>4,a=(15&o)<<4|i>>2,l=(3&i)<<6|u,s+=String.fromCharCode(r),64!=i&&(s+=String.fromCharCode(a)),64!=u&&(s+=String.fromCharCode(l)),r=a=l="",n=o=i=u="";while(c<t.length);return s}}}),angular.module("listnride").factory("bikeOptions",[function(){return{accessoryOptions:function(){return[{model:"has_lock",label:"lock"},{model:"has_helmet",label:"helmet"},{model:"has_lights",label:"lights"},{model:"has_basket",label:"basket"},{model:"has_trailer",label:"trailer"},{model:"has_childseat",label:"childseat"}]},sizeOptions:function(){return[{value:155,label:"155 cm - 165 cm"},{value:165,label:"165 cm - 175 cm"},{value:175,label:"175 cm - 185 cm"},{value:185,label:"185 cm - 195 cm"},{value:195,label:"195 cm - 205 cm"}]},kidsSizeOptions:function(){return[{value:85,label:"85 cm - 95 cm"},{value:95,label:"95 cm - 105 cm"},{value:105,label:"105 cm - 115 cm"},{value:115,label:"115 cm - 125 cm"},{value:125,label:"125 cm - 135 cm"},{value:135,label:"135 cm - 145 cm"},{value:145,label:"145 cm - 155 cm"}]},categoryOptions:function(){return[{value:1,label:"city"},{value:2,label:"race"},{value:3,label:"all terrain"},{value:4,label:"kids"},{value:5,label:"electro"},{value:6,label:"special"}]},subcategoryOptions:function(){return{1:[{value:0,label:"dutch-bike"},{value:1,label:"touring-bike"},{value:2,label:"fixie"},{value:3,label:"single-speed"}],2:[{value:0,label:"road-bike"},{value:1,label:"triathlon"},{value:2,label:"indoor"}],3:[{value:0,label:"tracking"},{value:1,label:"enduro"},{value:2,label:"freeride"},{value:3,label:"cross-country"},{value:4,label:"downhill"},{value:5,label:"cyclocross"}],4:[{value:0,label:"city"},{value:1,label:"all-terrain"},{value:2,label:"road"}],5:[{value:0,label:"pedelec"},{value:1,label:"e-bike"}],6:[{value:0,label:"folding-bike"},{value:1,label:"tandem"},{value:2,label:"cruiser"},{value:3,label:"cargo-bike"},{value:4,label:"recumbent"},{value:5,label:"mono-bike"}]}}}}]),angular.module("listnride").factory("date",["$translate",function(e){return{duration:function(t,r){if(void 0===t||void 0===r)return"0 "+e.instant("shared.days")+" , 0 "+e.instant("shared.hours");var t=new Date(t),r=new Date(r),a=Math.abs(t-r),n=a/1e3|0;a-=1e3*n;var o=n/60|0;n-=60*o;var i=o/60|0;o-=60*i;var s=i/24|0;i-=24*s;var l=s/7|0;s-=7*l;var u=1==l?e.instant("shared.week"):e.instant("shared.weeks"),c=1==s?e.instant("shared.day"):e.instant("shared.days"),d=1==i?e.instant("shared.hour"):e.instant("shared.hours"),m="";return l>0&&(m+=l+" "+u),s>0&&(m+=l>0?", "+s+" "+c:s+" "+c),i>0&&(m+=s>0||l>0?", "+i+" "+d:i+" "+d),m},subtotal:function(e,t,r,a,n){if(void 0===e||void 0===t)return 0;var o=Math.abs(e-t),i=o/1e3|0;o-=1e3*i;var s=i/60|0;i-=60*s;var l=s/60|0;s-=60*l;var u=l/24|0;l-=24*u;var c=u/7|0;u-=7*c;var d=n*c;return d+=a*u,0==c&&0==u?d+=l<=6?1*r:1*a:0<l&&l<6?d+=1*r:l>=6&&(d+=1*a),0==c&&d>n&&(d=1*n),d}}}]),angular.module("listnride").factory("loadingDialog",["$mdDialog",function(e){var t=function(t){e.show({templateUrl:"app/services/loading-dialog/loading-dialog.template.html",parent:angular.element(document.body),targetEvent:t,openFrom:angular.element(document.body),closeTo:angular.element(document.body),clickOutsideToClose:!1,escapeToClose:!1})},r=function(){e.hide()};return{open:t,close:r}}]),angular.module("listnride").factory("sha256",function(){return{encrypt:function(e){function t(e,t,r){return e&t^e&r^t&r}function r(e){return h(2,e)^h(13,e)^h(22,e)}function a(e){return h(6,e)^h(11,e)^h(25,e)}function n(e){return h(7,e)^h(18,e)^e>>>3}function o(e){return h(17,e)^h(19,e)^e>>>10}function i(e,t){return e[15&t]+=o(e[t+14&15])+e[t+9&15]+n(e[t+1&15])}function s(e,t){var r=(65535&e)+(65535&t),a=(e>>16)+(t>>16)+(r>>16);return a<<16|65535&r}function l(){p=new Array(8),f=new Array(2),g=new Array(64),f[0]=f[1]=0,p[0]=1779033703,p[1]=3144134277,p[2]=1013904242,p[3]=2773480762,p[4]=1359893119,p[5]=2600822924,p[6]=528734635,p[7]=1541459225}function u(){var e,n,o,l,u,c,d,m,f,h,y=new Array(16);e=p[0],n=p[1],o=p[2],l=p[3],u=p[4],c=p[5],d=p[6],m=p[7];for(var _=0;_<16;_++)y[_]=g[(_<<2)+3]|g[(_<<2)+2]<<8|g[(_<<2)+1]<<16|g[_<<2]<<24;for(var k=0;k<64;k++)f=m+a(u)+v(u,c,d)+b[k],f+=k<16?y[k]:i(y,k),h=r(e)+t(e,n,o),m=d,d=c,c=u,u=s(l,f),l=o,o=n,n=e,e=s(f,h);p[0]+=e,p[1]+=n,p[2]+=o,p[3]+=l,p[4]+=u,p[5]+=c,p[6]+=d,p[7]+=m}function c(e,t){var r,a,n=0;a=f[0]>>3&63;var o=63&t;for((f[0]+=t<<3)<t<<3&&f[1]++,f[1]+=t>>29,r=0;r+63<t;r+=64){for(var i=a;i<64;i++)g[i]=e.charCodeAt(n++);u(),a=0}for(var i=0;i<o;i++)g[i]=e.charCodeAt(n++)}function d(){var e=f[0]>>3&63;if(g[e++]=128,e<=56)for(var t=e;t<56;t++)g[t]=0;else{for(var t=e;t<64;t++)g[t]=0;u();for(var t=0;t<56;t++)g[t]=0}g[56]=f[1]>>>24&255,g[57]=f[1]>>>16&255,g[58]=f[1]>>>8&255,g[59]=255&f[1],g[60]=f[0]>>>24&255,g[61]=f[0]>>>16&255,g[62]=f[0]>>>8&255,g[63]=255&f[0],u()}function m(){for(var e=new String,t=0;t<8;t++)for(var r=28;r>=0;r-=4)e+=y.charAt(p[t]>>>r&15);return e}var p,f,g,h=function(e,t){return t>>>e|t<<32-e},v=function(e,t,r){return e&t^~e&r},b=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),y="0123456789abcdef";return l(),c(e,e.length),d(),m()}}}),angular.module("listnride").factory("verification",["$mdDialog","$mdToast","$interval","$localStorage","$state","$translate","api","Upload",function(e,t,r,a,n,o,i,s){var l=function(l){var u=this,c=r(function(){d()},5e3);u.lister=l,console.log(u.lister),u.selectedIndex,u.activeTab=1,u.firstName=a.firstName,u.profilePicture=!1,u.hasPicture=!1,"home"==n.current.name?u.firstTime=!0:u.firstTime=!1,u.$onDestroy=function(){r.cancel(c)};var d=function(){i.get("/users/"+a.userId).then(function(e){null==u.newUser&&(u.newUser=e.data,u.hasPicture="https://s3.eu-central-1.amazonaws.com/listnride/assets/default_profile_picture.jpg"!=u.newUser.profile_picture.profile_picture.url),u.user=e.data},function(e){console.log("Error fetching User Details")})};d();var m=function(){var e={user:{description:u.newUser.description}};i.put("/users/"+a.userId,e).then(function(e){console.log("Successfully updated description")},function(e){console.log("Error updating description")})},p=function(){var e={user:{profile_picture:u.profilePicture}};s.upload({method:"PUT",url:i.getApiUrl()+"/users/"+a.userId,data:e,headers:{Authorization:a.auth}}).then(function(e){console.log(e.data),a.profilePicture=e.data.profile_picture.profile_picture.url},function(e){console.log("Error while uploading profile picture",e)})},f=function(){var e={user:{street:u.newUser.street,zip:u.newUser.zip,city:u.newUser.city,country:u.newUser.country}};i.put("/users/"+a.userId,e).then(function(e){t.show(t.simple().textContent("Congratulations, your profile was successfully verified!").hideDelay(4e3).position("top center"))},function(e){})};u.resendEmail=function(){i.post("/users/"+a.userId+"/resend_confirmation_mail").then(function(e){t.show(t.simple().textContent(o.instant("toasts.verification-email-sent")).hideDelay(6e3).position("top center"))},function(e){})},u.sendSms=function(){var e={phone_number:u.newUser.phone_number};i.post("/users/"+a.userId+"/update_phone",e).then(function(e){console.log("Successfully updated phone number"),t.show(t.simple().textContent("An SMS with a confirmation code was sent to you right now.").hideDelay(4e3).position("top center"))},function(e){console.log("error updating phone number")})},u.confirmPhone=function(){var e={confirmation_code:u.newUser.confirmation_code};i.post("/users/"+a.userId+"/confirm_phone",e).then(function(e){t.show(t.simple().textContent("Successfully verified phone number.").hideDelay(4e3).position("top center"))},function(e){t.show(t.simple().textContent("Error: The Verification Code seems to be invalid.").hideDelay(4e3).position("top center"))})},u.uploadAddress=function(){var e={user:{street:u.newUser.street,zip:u.newUser.zip,city:u.newUser.city,country:u.newUser.country}};i.put("/users/"+a.userId,e).then(function(e){t.show(t.simple().textContent("You've successfully verified your profile, thank you!").hideDelay(5e3).position("top center"))},function(e){console.log("error updating address")})},u.next=function(){switch(u.activeTab){case 1:u.selectedIndex+=1;break;case 2:p(),u.selectedIndex+=1;break;case 3:m(),u.selectedIndex+=1;break;case 4:u.selectedIndex+=1;break;case 5:u.selectedIndex+=1;break;case 6:f(),e.hide()}},u.nextDisabled=function(){switch(u.activeTab){case 1:return!1;case 2:return!u.profilePicture;case 3:return!u.descriptionForm.$valid;case 4:return 0==u.user.status;case 5:return!u.user.confirmed_phone;case 6:return!u.addressForm.$valid}},u.hide=function(){e.hide()},u.fillAddress=function(e){var t=e.address_components;if(t){for(var r={street_number:"",route:"",locality:"",country:"",postal_code:""},a=0;a<t.length;a++){var n=t[a].types[0];n in r&&(r[n]=t[a].long_name)}u.newUser.street=r.route+" "+r.street_number,u.newUser.zip=r.postal_code,u.newUser.city=r.locality,u.newUser.country=r.country}}};l.$inject=["lister"];var u=function(t,r){e.show({controller:l,locals:{lister:t},controllerAs:"verificationDialog",templateUrl:"app/services/verification/verification.template.html",parent:angular.element(document.body),targetEvent:r,openFrom:angular.element(document.body),closeTo:angular.element(document.body),clickOutsideToClose:!1,escapeToClose:!1,fullscreen:!0})};return{openDialog:u}}]),angular.module("raphaSuperCross",[]).component("raphaSuperCross",{templateUrl:"app/modules/events/rapha-super-cross/rapha-super-cross.template.html",controllerAs:"raphaSuperCross",controller:["NgMap","api",function(e,t){var r=this;t.get("/rides?family=7").then(function(e){r.bikes=e.data},function(e){console.log("Error retrieving User",e)})}]}),angular.module("autocomplete",[]).component("autocomplete",{templateUrl:"app/modules/shared/autocomplete/autocomplete.template.html",controllerAs:"autocomplete",bindings:{autocompleteId:"@",location:"=",labelId:"@",placeholderId:"@",required:"@",fillAddress:"&"},controller:["$interval","$scope","$timeout",function(e,t,r){var a=this,n=t.$watch(function(){return document.getElementById(a.autocompleteId)},function(e){if(e){n();var r=new google.maps.places.Autocomplete(document.getElementById(a.autocompleteId),{types:["geocode"]});r.addListener("place_changed",function(){t.$apply(function(){void 0!==a.fillAddress&&a.fillAddress({place:r.getPlace()})})})}}),o=e(function(){if($(".pac-container").length>0){var t=$(".pac-container").detach();t.appendTo("autocomplete"),e.cancel(o)}},100)}]}),angular.module("bikeCard",[]).component("bikeCard",{templateUrl:"app/modules/shared/bike-card/bike-card.template.html",controllerAs:"bikeCard",bindings:{bike:"<"},controller:[function(){}]}),angular.module("listingCard",[]).component("listingCard",{templateUrl:"app/modules/shared/listing-card/listing-card.template.html",controllerAs:"listingCard",bindings:{bikeId:"<",name:"<",brand:"<",category:"<",price:"<",imageUrl:"<",available:"<",removeBike:"&"},controller:["$state","$mdDialog","$translate","api",function(e,t,r,a){function n(){o.disableDelete=!0,a.put("/rides/"+o.bikeId,{ride:{active:"false"}}).then(function(e){o.removeBike({bikeId:o.bikeId})},function(e){console.log("Error deleting bike",e)})}var o=this;o.onDeleteClick=function(e){var a=t.confirm().title(r.instant("listingCard.dialog-title")).textContent(r.instant("listingCard.dialog-subtitle")).targetEvent(e).ok(r.instant("listingCard.delete")).cancel(r.instant("listingCard.cancel"));t.show(a).then(function(){n()},function(){})},o.onActivateClick=function(){o.disableActivate=!0,a.put("/rides/"+o.bikeId,{ride:{available:"true"}}).then(function(e){o.disableActivate=!1,o.available=!0},function(e){o.disableActivate=!1,console.log("Error activating bike",e)})},o.onDeactivateClick=function(){o.disableDeactivate=!0,a.put("/rides/"+o.bikeId,{ride:{available:"false"}}).then(function(e){o.disableDeactivate=!1,o.available=!1},function(e){o.disableDeactivate=!1,console.log("Error deactivating bike",e)})}}]}),angular.module("message",[]).component("message",{templateUrl:"app/modules/shared/message/message.template.html",controllerAs:"message",bindings:{content:"<",status:"<",sender:"<",receiver:"<",timestamp:"<",confirmBooking:"&",showRatingDialog:"&",request:"<"},controller:["$translate","$localStorage","$mdDialog","api",function(e,t,r,a){var n=this;n.closeDialog=function(){r.hide()},n.sentMessage=function(){return null==n.status&&t.userId==n.sender},n.receivedMessage=function(){return null==n.status&&t.userId!=n.sender},n.statusMessage=function(){return n.request.rideChat?null!=n.status&&7!=n.status:null!=n.status&&7!=n.status&&6!=n.status},n.updateStatus=function(e){var r={request_id:n.request.id,sender:t.userId,status:e,content:""};n.request.messages.push(r);var r={request:{status:e}};n.request.status=e,a.put("/requests/"+n.request.id,r).then(function(e){console.log("successfully updated request")},function(e){console.log("error updating request")})}}]}),angular.module("rating",[]).component("rating",{templateUrl:"app/modules/shared/rating/rating.template.html",controllerAs:"rating",bindings:{data:"<"},controller:["api",function(e){}]});