<!-- All views except XS -->
<div flex="100" layout="row" layout-fill>

  <!-- Left Column displaying list of all Requests -->
  <md-content flex-gt-xs="25" flex="100" class="requests-list" flex-order="1">
    <div flex layout="row" layout-align="space-around center">
      <section layout="row" layout-align="space-around center">
        <md-button md-no-ink 
                   ng-class="{'request-filter-switch-active':requests.filters.type == 'all'}" 
                   class="request-filter-switch left md-noink"
                   ng-click="requests.filterBikes('all', true)">
                   All
        </md-button>
        <md-button md-no-ink
                   ng-class="{'request-filter-switch-active':requests.filters.type == 'lister'}"  
                   class="request-filter-switch middle" 
                   ng-click="requests.filterBikes('lister', true)">
                   Lister
        </md-button>
        <md-button md-no-ink
                   ng-class="{'request-filter-switch-active':requests.filters.type == 'rider'}"  
                   class="request-filter-switch right" 
                   ng-click="requests.filterBikes('rider', true)">
                   Rider
        </md-button>
      </section>
    </div>
    <div flex layout="row" layout-align="space-around center">
      <md-input-container class="request-filter-dropdown md-block">
        <md-select ng-model="requests.filters.selected" ng-change="requests.filters.applyFilter(requests.filters.selected)">
          <md-option ng-repeat="filter in ::requests.filters.options" value="{{$index}}">{{filter | titlecase}}</md-option>
        </md-select>
      </md-input-container>
    </div>

    <md-progress-linear class="md-accent" ng-if="requests.loadingList" md-mode="query"></md-progress-linear>
    <div layout="column" 
         layout-align="center center" 
         layout-fill 
         ng-if="!requests.loadingList && requests.requests.length == 0">
         <p class="requests-list-no-item lnr-center">{{ 'requests.no-requests-yet' | translate }}</p>
    </div>

    <md-list class="lnr-no-padding" md-no-ink ng-if="requests.requests != []">
      <div ng-repeat="request in requests.requests">
        <md-divider md-insets></md-divider>
        <md-list-item class="requests-list-item md-2-line" 
                      ng-class="{'request-filter-switch-active':requests.selected === request.id}"
                      ng-click="requests.loadRequest(request.id)">
          <img ng-src="{{requests.profilePicture(request)}}" class="md-avatar" alt="{{item.who}}" />
          <div class="md-list-item-text" layout="column">
            <h4 ng-if="request.last_message.is_read">{{request.ride.name}}</h4>
            <p ng-if="requests.is_rider(request)">{{ request.ride.category | category }}</p>
            <p ng-if="request.last_message.is_read && requests.is_lister(request)">{{request.timespan}}</p>
            <h4 ng-if="!request.last_message.is_read" class="lnr-bold">{{request.ride.name}}</h4>
            <p ng-if="!request.last_message.is_read && requests.is_lister(request)" class="lnr-bold">{{request.timespan}}</p>
          </div>
        </md-list-item>
      </div>
      <md-divider md-insets></md-divider>
    </md-list>
  </md-content>

  <!-- Right Column displaying actual Chat -->
  <div flex-order="2" layout="column" layout-fill hide-xs>
    <md-progress-linear class="md-accent" ng-if="requests.loadingChat" md-mode="query"></md-progress-linear>
    <div scroll-glue="requests.request.glued" class="chat" flex="90">
      <message ng-repeat="message in requests.request.messages" content="message.content" sender="message.sender" status="message.status"
        request="requests.request" confirm-booking="requests.confirmBooking()" show-rating-dialog="requests.showRatingDialog()"></message>
    </div>
    <form class="lnr-message-form" ng-submit="requests.sendMessage()" layout="row" layout-padding ng-if="requests.request.messages">
      <md-input-container class="ap-chat" flex md-no-float>
        <input ng-model="requests.message" placeholder="{{ 'requests.write-message' | translate }}"></input>
      </md-input-container>
      <md-input-container layout="row" hide-xs flex-gt-sm="20" flex="30">
        <md-button flex class="md-raised md-primary lnr-no-margin" type="submit">{{ 'shared.send' | translate }}</md-button>
      </md-input-container>
    </form>
  </div>
</div>